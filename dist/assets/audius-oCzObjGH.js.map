{"version":3,"file":"audius-oCzObjGH.js","sources":["../../../vue/src/composables/data/useDebouncedSearch.ts","../../../vue/src/stores/audius.ts"],"sourcesContent":["import { watch, ref } from \"vue\";\n\nexport function useDebouncedSearch(search: any, timeoutDuration = 300) {\n  const query = ref(\"\");\n  const results = ref<any[]>([]);\n  const timeout = ref();\n\n  watch(\n    () => query.value,\n    async (val) => {\n      if (val.length > 2) {\n        clearTimeout(timeout.value);\n        timeout.value = setTimeout(async () => {\n          results.value = await search(query.value);\n        }, timeoutDuration);\n      } else {\n        results.value = [];\n      }\n    }\n  );\n\n  return {\n    query,\n    results,\n  };\n}\n","import { defineStore, acceptHMRUpdate } from \"pinia\";\nimport { ref } from \"vue\";\nimport { useDebouncedSearch } from \"../composables/data/useDebouncedSearch\";\n\nconst API = import.meta.env.VITE_API;\nconst RANGES = [\"week\", \"month\"] as const;\ntype Range = (typeof RANGES)[number];\n\nexport const useAudius = defineStore(\"audius\", () => {\n  const { query, results } = useDebouncedSearch(search);\n\n  const trending = ref({\n    tracks: { week: [], month: [], year: [] },\n    playlists: { week: [], month: [], year: [] },\n  });\n\n  async function search(q: string) {\n    const res = await fetch(`${API}/api/audius/search/${encodeURIComponent(q)}`);\n    const data = await res.json();\n    return data;\n  }\n\n  async function fetchUser(handle: string) {\n    const res = await fetch(`${API}/api/audius/users/${encodeURIComponent(handle)}`);\n    const data = await res.json();\n    return data;\n  }\n\n  async function fetchPlaylistById(id: string) {\n    const res = await fetch(`${API}/api/audius/playlists/${encodeURIComponent(id)}`);\n    const data = await res.json();\n    return data;\n  }\n\n  async function fetchTrending() {\n    const res = await fetch(`${API}/api/audius/trending`);\n    const data = await res.json();\n    console.log(data);\n    trending.value.tracks = data.tracks;\n    trending.value.playlists = data.playlists;\n    return data;\n  }\n\n  async function getTrackStream(trackId: string) {\n    const res = await fetch(`${API}/api/audius/stream/${encodeURIComponent(trackId)}`);\n    const data = await res.json();\n    return data;\n  }\n\n  return {\n    query,\n    results,\n    trending,\n    fetchTrending,\n    fetchPlaylistById,\n    fetchUser,\n    getTrackStream,\n  };\n});\n\nif (import.meta.hot) {\n  import.meta.hot.accept(acceptHMRUpdate(useAudius, import.meta.hot));\n}\n"],"names":["useDebouncedSearch","search","timeoutDuration","query","ref","results","timeout","watch","val","API","useAudius","defineStore","trending","q","fetchUser","handle","fetchPlaylistById","id","fetchTrending","data","getTrackStream","trackId"],"mappings":"uDAEO,SAASA,EAAmBC,EAAaC,EAAkB,IAAK,CACrE,MAAMC,EAAQC,EAAI,EAAE,EACdC,EAAUD,EAAW,EAAE,EACvBE,EAAUF,EAAA,EAEhB,OAAAG,EACE,IAAMJ,EAAM,MACZ,MAAOK,GAAQ,CACTA,EAAI,OAAS,GACf,aAAaF,EAAQ,KAAK,EAC1BA,EAAQ,MAAQ,WAAW,SAAY,CACrCD,EAAQ,MAAQ,MAAMJ,EAAOE,EAAM,KAAK,CAC1C,EAAGD,CAAe,GAElBG,EAAQ,MAAQ,CAAA,CAEpB,CAAA,EAGK,CACL,MAAAF,EACA,QAAAE,CAAA,CAEJ,CCrBA,MAAMI,EAAM,wBAICC,EAAYC,EAAY,SAAU,IAAM,CACnD,KAAM,CAAE,MAAAR,EAAO,QAAAE,GAAYL,EAAmBC,CAAM,EAE9CW,EAAWR,EAAI,CACnB,OAAQ,CAAE,KAAM,CAAA,EAAI,MAAO,CAAA,EAAI,KAAM,EAAC,EACtC,UAAW,CAAE,KAAM,CAAA,EAAI,MAAO,CAAA,EAAI,KAAM,CAAA,CAAC,CAAE,CAC5C,EAED,eAAeH,EAAOY,EAAW,CAG/B,OADa,MADD,MAAM,MAAM,GAAGJ,CAAG,sBAAsB,mBAAmBI,CAAC,CAAC,EAAE,GACpD,KAAA,CAEzB,CAEA,eAAeC,EAAUC,EAAgB,CAGvC,OADa,MADD,MAAM,MAAM,GAAGN,CAAG,qBAAqB,mBAAmBM,CAAM,CAAC,EAAE,GACxD,KAAA,CAEzB,CAEA,eAAeC,EAAkBC,EAAY,CAG3C,OADa,MADD,MAAM,MAAM,GAAGR,CAAG,yBAAyB,mBAAmBQ,CAAE,CAAC,EAAE,GACxD,KAAA,CAEzB,CAEA,eAAeC,GAAgB,CAE7B,MAAMC,EAAO,MADD,MAAM,MAAM,GAAGV,CAAG,sBAAsB,GAC7B,KAAA,EACvB,eAAQ,IAAIU,CAAI,EAChBP,EAAS,MAAM,OAASO,EAAK,OAC7BP,EAAS,MAAM,UAAYO,EAAK,UACzBA,CACT,CAEA,eAAeC,EAAeC,EAAiB,CAG7C,OADa,MADD,MAAM,MAAM,GAAGZ,CAAG,sBAAsB,mBAAmBY,CAAO,CAAC,EAAE,GAC1D,KAAA,CAEzB,CAEA,MAAO,CACL,MAAAlB,EACA,QAAAE,EACA,SAAAO,EACA,cAAAM,EACA,kBAAAF,EACA,UAAAF,EACA,eAAAM,CAAA,CAEJ,CAAC"}
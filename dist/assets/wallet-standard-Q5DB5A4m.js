import{at as $,au as B,av as A,aw as X,ax as x,ay as O,az as tt}from"./index-xeh6oSzU.js";var et=function(s,e,t,a){if(t==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!a:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?a:t==="a"?a.call(s):a?a.value:e.get(s)},at=function(s,e,t,a,i){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!i:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?i.call(s,t):i?i.value=t:e.set(s,t),t},_;function G(s){const e=({register:t})=>t(s);try{window.dispatchEvent(new nt(e))}catch(t){console.error(`wallet-standard:register-wallet event could not be dispatched
`,t)}try{window.addEventListener("wallet-standard:app-ready",({detail:t})=>e(t))}catch(t){console.error(`wallet-standard:app-ready event listener could not be added
`,t)}}class nt extends Event{get detail(){return et(this,_,"f")}get type(){return"wallet-standard:register-wallet"}constructor(e){super("wallet-standard:register-wallet",{bubbles:!1,cancelable:!1,composed:!1}),_.set(this,void 0),at(this,_,e,"f")}preventDefault(){throw new Error("preventDefault cannot be called")}stopImmediatePropagation(){throw new Error("stopImmediatePropagation cannot be called")}stopPropagation(){throw new Error("stopPropagation cannot be called")}}_=new WeakMap;const st={solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},y={mainnet:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedMainnet:"4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ",devnet:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedDevnet:"8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"};function it(s){return st[s]||[]}function ot(s){return{methods:it(s),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}}function rt(s){return s.reduce((e,t)=>{const{id:a,chainNamespace:i,rpcUrls:r}=t,d=r.default.http[0];e[i]||(e[i]=ot(i));const M=`${i}:${a}`,o=e[i];switch(o?.chains.push(M),M){case y.mainnet:o.chains.push(y.deprecatedMainnet);break;case y.devnet:o.chains.push(y.deprecatedDevnet);break}return o?.rpcMap&&d&&(o.rpcMap[a]=d),e},{})}const R=["solana:mainnet","solana:devnet","solana:testnet","solana:localnet"];var g=function(s,e,t,a){if(t==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!a:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?a:t==="a"?a.call(s):a?a.value:e.get(s)},D=function(s,e,t,a,i){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!i:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?i.call(s,t):i?i.value=t:e.set(s,t),t},S,E,m,z,W,C;class lt{get address(){return g(this,S,"f")}get publicKey(){return g(this,E,"f").slice()}get chains(){return g(this,m,"f").slice()}get features(){return g(this,z,"f").slice()}get label(){return g(this,W,"f")}get icon(){return g(this,C,"f")}constructor({address:e,publicKey:t,label:a,icon:i}){S.set(this,void 0),E.set(this,void 0),m.set(this,void 0),z.set(this,void 0),W.set(this,void 0),C.set(this,void 0),D(this,S,e,"f"),D(this,E,t,"f"),D(this,m,R,"f"),D(this,z,["solana:signAndSendTransaction","solana:signTransaction","solana:signMessage"],"f"),D(this,W,a,"f"),D(this,C,i,"f")}}S=new WeakMap,E=new WeakMap,m=new WeakMap,z=new WeakMap,W=new WeakMap,C=new WeakMap;function Y(s){return R.includes(s)}function j(s){return"version"in s}var n=function(s,e,t,a){if(t==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!a:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?a:t==="a"?a.call(s):a?a.value:e.get(s)},p=function(s,e,t,a,i){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!i:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?i.call(s,t):i?i.value=t:e.set(s,t),t},N,u,Q,c,L,k,l,P,F,Z,T,v,I,q,K,b,H,U;function ct(s){return{"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"solana:mainnet","solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ":"solana:mainnet","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"solana:testnet","solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K":"solana:devnet","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1":"solana:devnet"}[s]}class V{static register(e){const t=new V(e);G(t)}get version(){return n(this,Q,"f")}get name(){return n(this,L,"f")}get icon(){return n(this,k,"f")}get chains(){return R.slice()}get features(){return{"standard:connect":{version:"1.0.0",connect:n(this,q,"f")},"standard:disconnect":{version:"1.0.0",disconnect:n(this,K,"f")},"standard:events":{version:"1.0.0",on:n(this,P,"f")},"solana:signAndSendTransaction":{version:"1.0.0",supportedTransactionVersions:["legacy",0],signAndSendTransaction:n(this,b,"f")},"solana:signTransaction":{version:"1.0.0",supportedTransactionVersions:["legacy",0],signTransaction:n(this,H,"f")},"solana:signMessage":{version:"1.0.0",signMessage:n(this,U,"f")}}}get accounts(){const e=n(this,c,"f").session?.namespaces?.solana,t=e?.chains?.map(a=>ct(a));return e?.accounts.map(a=>{const{address:i}=$.parseCaipAddress(a),r=new B(A.decode(i));return{address:i,publicKey:r.toBytes(),chains:t,features:["solana:signAndSendTransaction","solana:signTransaction","solana:signMessage"]}})||[]}constructor(e){N.add(this),u.set(this,{}),Q.set(this,"1.0.0"),c.set(this,void 0),L.set(this,"WalletConnect"),k.set(this,"data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjE4NSIgdmlld0JveD0iMCAwIDMwMCAxODUiIHdpZHRoPSIzMDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0ibTYxLjQzODU0MjkgMzYuMjU2MjYxMmM0OC45MTEyMjQxLTQ3Ljg4ODE2NjMgMTI4LjIxMTk4NzEtNDcuODg4MTY2MyAxNzcuMTIzMjA5MSAwbDUuODg2NTQ1IDUuNzYzNDE3NGMyLjQ0NTU2MSAyLjM5NDQwODEgMi40NDU1NjEgNi4yNzY1MTEyIDAgOC42NzA5MjA0bC0yMC4xMzY2OTUgMTkuNzE1NTAzYy0xLjIyMjc4MSAxLjE5NzIwNTEtMy4yMDUzIDEuMTk3MjA1MS00LjQyODA4MSAwbC04LjEwMDU4NC03LjkzMTE0NzljLTM0LjEyMTY5Mi0zMy40MDc5ODE3LTg5LjQ0Mzg4Ni0zMy40MDc5ODE3LTEyMy41NjU1Nzg4IDBsLTguNjc1MDU2MiA4LjQ5MzYwNTFjLTEuMjIyNzgxNiAxLjE5NzIwNDEtMy4yMDUzMDEgMS4xOTcyMDQxLTQuNDI4MDgwNiAwbC0yMC4xMzY2OTQ5LTE5LjcxNTUwMzFjLTIuNDQ1NTYxMi0yLjM5NDQwOTItMi40NDU1NjEyLTYuMjc2NTEyMiAwLTguNjcwOTIwNHptMjE4Ljc2Nzc5NjEgNDAuNzczNzQ0OSAxNy45MjE2OTcgMTcuNTQ2ODk3YzIuNDQ1NTQ5IDIuMzk0Mzk2OSAyLjQ0NTU2MyA2LjI3NjQ3NjkuMDAwMDMxIDguNjcwODg5OWwtODAuODEwMTcxIDc5LjEyMTEzNGMtMi40NDU1NDQgMi4zOTQ0MjYtNi40MTA1ODIgMi4zOTQ0NTMtOC44NTYxNi4wMDAwNjItLjAwMDAxLS4wMDAwMS0uMDAwMDIyLS4wMDAwMjItLjAwMDAzMi0uMDAwMDMybC01Ny4zNTQxNDMtNTYuMTU0NTcyYy0uNjExMzktLjU5ODYwMi0xLjYwMjY1LS41OTg2MDItMi4yMTQwNCAwLS4wMDAwMDQuMDAwMDA0LS4wMDAwMDcuMDAwMDA4LS4wMDAwMTEuMDAwMDExbC01Ny4zNTI5MjEyIDU2LjE1NDUzMWMtMi40NDU1MzY4IDIuMzk0NDMyLTYuNDEwNTc1NSAyLjM5NDQ3Mi04Ljg1NjE2MTIuMDAwMDg3LS4wMDAwMTQzLS4wMDAwMTQtLjAwMDAyOTYtLjAwMDAyOC0uMDAwMDQ0OS0uMDAwMDQ0bC04MC44MTI0MTk0My03OS4xMjIxODVjLTIuNDQ1NTYwMjEtMi4zOTQ0MDgtMi40NDU1NjAyMS02LjI3NjUxMTUgMC04LjY3MDkxOTdsMTcuOTIxNzI5NjMtMTcuNTQ2ODY3M2MyLjQ0NTU2MDItMi4zOTQ0MDgyIDYuNDEwNTk4OS0yLjM5NDQwODIgOC44NTYxNjAyIDBsNTcuMzU0OTc3NSA1Ni4xNTUzNTdjLjYxMTM5MDguNTk4NjAyIDEuNjAyNjQ5LjU5ODYwMiAyLjIxNDAzOTggMCAuMDAwMDA5Mi0uMDAwMDA5LjAwMDAxNzQtLjAwMDAxNy4wMDAwMjY1LS4wMDAwMjRsNTcuMzUyMTAzMS01Ni4xNTUzMzNjMi40NDU1MDUtMi4zOTQ0NjMzIDYuNDEwNTQ0LTIuMzk0NTUzMSA4Ljg1NjE2MS0uMDAwMi4wMDAwMzQuMDAwMDMzNi4wMDAwNjguMDAwMDY3My4wMDAxMDEuMDAwMTAxbDU3LjM1NDkwMiA1Ni4xNTU0MzJjLjYxMTM5LjU5ODYwMSAxLjYwMjY1LjU5ODYwMSAyLjIxNDA0IDBsNTcuMzUzOTc1LTU2LjE1NDMyNDljMi40NDU1NjEtMi4zOTQ0MDkyIDYuNDEwNTk5LTIuMzk0NDA5MiA4Ljg1NjE2IDB6IiBmaWxsPSIjM2I5OWZjIi8+PC9zdmc+"),l.set(this,null),P.set(this,(t,a)=>(n(this,u,"f")[t]||(n(this,u,"f")[t]=[]),n(this,u,"f")[t].push(a),()=>n(this,N,"m",Z).call(this,t,a))),T.set(this,()=>{const t=this.accounts[0];t?.publicKey&&(p(this,l,new lt(t),"f"),n(this,N,"m",F).call(this,"change",{accounts:this.accounts}))}),v.set(this,()=>{n(this,l,"f")&&(p(this,l,null,"f"),n(this,N,"m",F).call(this,"change",{accounts:this.accounts}))}),I.set(this,()=>{n(this,c,"f").session?.namespaces?.solana?.accounts.length?n(this,T,"f").call(this):n(this,v,"f").call(this)}),q.set(this,async()=>(n(this,l,"f")||(X.push("ConnectingWalletConnect"),await n(this,c,"f").connect({namespaces:rt([tt.DEFAULT_CHAIN])})),n(this,T,"f").call(this),{accounts:this.accounts})),K.set(this,async()=>{await n(this,c,"f").disconnect()}),b.set(this,async(...t)=>{if(!n(this,l,"f"))throw new Error("not connected");const a=[];if(t.length===1){const{transaction:i,account:r,chain:d,options:M}=t[0]||{},{minContextSlot:o,preflightCommitment:w,skipPreflight:f,maxRetries:h}=M||{};if(r?.address!==n(this,l,"f")?.address)throw new Error("invalid account");if(!Y(d||":"))throw new Error("invalid chain");if(!i)throw new Error("invalid transaction");const J=await n(this,c,"f").request({method:"solana_signAndSendTransaction",params:{transaction:i,pubkey:n(this,l,"f").address,sendOptions:{preflightCommitment:w,minContextSlot:o,maxRetries:h,skipPreflight:f}}});a.push({signature:A.decode(J.signature)})}else if(t.length>1){const i=await Promise.all(t.map(r=>n(this,b,"f").call(this,r)));for(const r of i)a.push(...r)}return a}),H.set(this,async(...t)=>{if(!n(this,l,"f"))throw new Error("not connected");const a=[];if(t.length===1){const{transaction:i,account:r,chain:d}=t[0]||{};if(r?.address!==n(this,l,"f").address)throw new Error("invalid account");if(d&&!Y(d))throw new Error("invalid chain");if(!i)throw new Error("invalid transaction");const M=x.from(i);let o;const w=await n(this,c,"f").request({method:"solana_signTransaction",params:{transaction:i,pubkey:n(this,l,"f").address}});if("signature"in w){const h=A.decode(w.signature);M.addSignature(new B(n(this,l,"f").publicKey),Buffer.from(h)),o=M}else{const h=Buffer.from(w.transaction,"base64");j(M)&&(o=O.deserialize(new Uint8Array(h))),o=x.from(h)}if(!o)throw new Error("invalid transaction");const f=j(o)?o.serialize():new Uint8Array(o.serialize({requireAllSignatures:!1,verifySignatures:!1}));a.push({signedTransaction:f})}else if(t.length>1){let i;for(const o of t){if(o.account?.address!==n(this,l,"f").address)throw new Error("invalid account");if(o.chain){if(!Y(o.chain))throw new Error("invalid chain");if(i&&o.chain!==i)throw new Error("conflicting chain");i=o.chain}}const r=t.map(({transaction:o})=>O.deserialize(o)),M=(await n(this,c,"f").request({method:"solana_signAllTransactions",params:{transactions:r}})).transactions.map((o,w)=>{const f=r[w];if(!f)throw new Error("Invalid transactions response");const h=Buffer.from(o,"base64");return j(f)?O.deserialize(new Uint8Array(h)):x.from(h)});a.push(...M.map(o=>({signedTransaction:j(o)?o.serialize():new Uint8Array(o.serialize({requireAllSignatures:!1,verifySignatures:!1}))})))}return a}),U.set(this,async(...t)=>{if(!n(this,l,"f"))throw new Error("not connected");const a=[];if(t.length===1){const{message:i,account:r}=t[0]||{};if(r?.address!==n(this,l,"f").address)throw new Error("invalid account");if(!i)throw new Error("invalid message");const d=await n(this,c,"f").request({method:"solana_signMessage",params:{message:i,pubkey:n(this,l,"f").address}});a.push({signedMessage:i,signature:A.decode(d.signature)})}else if(t.length>1){const i=await Promise.all(t.map(r=>n(this,U,"f").call(this,r)));for(const r of i)a.push(...r)}return a}),p(this,c,e,"f"),this.setProvider(e),G(this)}setProvider(e){p(this,c,e,"f"),p(this,L,"WalletConnect","f"),e.on("connect",()=>n(this,T,"f").call(this)),e.on("disconnect",()=>n(this,v,"f").call(this)),e.on("accountsChanged",()=>n(this,I,"f").call(this)),e.on("chainChanged",()=>n(this,I,"f").call(this)),n(this,T,"f").call(this)}}u=new WeakMap,Q=new WeakMap,c=new WeakMap,L=new WeakMap,k=new WeakMap,l=new WeakMap,P=new WeakMap,T=new WeakMap,v=new WeakMap,I=new WeakMap,q=new WeakMap,K=new WeakMap,b=new WeakMap,H=new WeakMap,U=new WeakMap,N=new WeakSet,F=function(e,...t){n(this,u,"f")[e]?.forEach(a=>a.apply(null,t))},Z=function(e,t){n(this,u,"f")[e]=n(this,u,"f")[e]?.filter(a=>t!==a)};export{V as SolanaWalletConnectStandardWallet};
//# sourceMappingURL=wallet-standard-Q5DB5A4m.js.map

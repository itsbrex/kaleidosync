(function(t){function e(e){for(var a,r,o=e[0],c=e[1],l=e[2],h=0,v=[];h<o.length;h++)r=o[h],n[r]&&v.push(n[r][0]),n[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(e);while(v.length)v.shift()();return s.push.apply(s,l||[]),i()}function i(){for(var t,e=0;e<s.length;e++){for(var i=s[e],a=!0,o=1;o<i.length;o++){var c=i[o];0!==n[c]&&(a=!1)}a&&(s.splice(e--,1),t=r(r.s=i[0]))}return t}var a={},n={app:0},s=[];function r(e){if(a[e])return a[e].exports;var i=a[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=a,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(i,a,function(e){return t[e]}.bind(null,a));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var u=c;s.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"07a3":function(t,e,i){},1532:function(t,e,i){},1661:function(t,e,i){},"1f6d":function(t,e,i){t.exports=i.p+"img/blobs.d7d02f93.jpg"},"1fbc":function(t,e,i){t.exports=i.p+"img/trails.b699bbcb.png"},"24c5":function(t,e,i){},"3cf0":function(t,e,i){"use strict";var a=i("1661"),n=i.n(a);n.a},4158:function(t,e,i){},"56d7":function(t,e,i){"use strict";i.r(e);i("cadf"),i("551c"),i("f751"),i("097d"),i("796e");var a=i("2b0e"),n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"router-view"}},[i("router-view")],1)},s=[],r=(i("5c0b"),i("2877")),o={},c=Object(r["a"])(o,n,s,!1,null,null,null),l=c.exports,u=i("8c4f"),h=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"home",style:{color:t.color,transition:"all "+t.colorTransitionDuration+"ms"}},[i("div",{staticClass:"splash",class:{hide:t.hide}},[i("h1",{ref:"logo"},[i("span",{attrs:{"data-letter":"1"}},[t._v("K")]),i("span",{attrs:{"data-letter":"2"}},[t._v("a")]),i("span",{attrs:{"data-letter":"3"}},[t._v("l")]),i("span",{attrs:{"data-letter":"4"}},[t._v("e")]),i("span",{attrs:{"data-letter":"5"}},[t._v("i")]),i("span",{attrs:{"data-letter":"6"}},[t._v("d")]),i("span",{attrs:{"data-letter":"7"}},[t._v("o")]),i("span",{attrs:{"data-letter":"8"}},[t._v("s")]),i("span",{attrs:{"data-letter":"9"}},[t._v("y")]),i("span",{attrs:{"data-letter":"10"}},[t._v("n")]),i("span",{ref:"last",attrs:{"data-letter":"11"}},[t._v("c")])]),i("div",{staticClass:"text"},[i("h2",[t._v("A Spotify visualizer")]),i("noscript",[t._v("Please enable JavaScript before logging in.")]),i("div",{staticClass:"buttons"},[i("button",{staticClass:"button",style:{color:t.color,borderColor:t.color,transition:"opacity "+t.colorTransitionDuration+"ms, transform "+t.colorTransitionDuration+"ms"},on:{click:t.login}},[t._v("Log In")]),i("div",{staticClass:"github",style:{transition:"all "+t.colorTransitionDuration+"ms"}},[i("a",{attrs:{href:"https://github.com/zachwinter/kaleidosync",target:"_blank"}}),i("GitHub",{attrs:{color:t.color,colorTransitionDuration:t.colorTransitionDuration}})],1)])])])])},v=[],d=i("cebc"),f=i("2f62"),m=(i("6c7b"),i("5d73")),g=i.n(m),b=i("768b"),p=(i("ac6a"),i("75fc")),y=i("5176"),w=i.n(y),k=i("d225"),S=i("b0b4"),O=i("308d"),x=i("6bb5"),_=i("4e2b"),j=(i("7f7f"),i("d263"),i("795b")),T=i.n(j),A=(i("5df3"),i("f499")),C=i.n(A),z=(i("96cf"),i("3b8d")),I=i("a745"),E=i.n(I),M=i("dffd"),P=i.n(M),F=i("7618");function V(t){var e=Object(F["a"])(t);return null==t||"object"!=e&&"function"!=e}function R(t){var e=P()(Object(d["a"])({},t)),i={__all__:[]};for(var a in e)i[a]=[];var n={set:function(t,e,a){var n;return n=V(t[e])?t[e]:E()(t[e])?Object(p["a"])(t[e]):Object(d["a"])({},t[e]),t[e]=a,i[e]&&(i[e].map(function(t){return t(a,n)}),i.__all__.map(function(t){return t(a,n)})),!0}};return new Proxy(Object(d["a"])({},e,{watch:function(t,e){"string"===typeof t&&t in i&&i[t].push(e),"function"===typeof t&&i.__all__.push(t)}}),{set:n.set})}i("28a5"),i("c5f6"),i("3b2b"),i("a481");function $(t){return t&&decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null}function L(t,e,i,a,n,s){if(!t||/^(?:expires|max\-age|path|domain|secure)$/i.test(t))return!1;var r="";if(i)switch(i.constructor){case Number:r=i===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+i;break;case String:r="; expires="+i;break;case Date:r="; expires="+i.toUTCString();break}return document.cookie=encodeURIComponent(t)+"="+encodeURIComponent(e)+r+(n?"; domain="+n:"")+(a?"; path="+a:"")+(s?"; secure":""),!0}function D(t,e,i,a){var n=new XMLHttpRequest;for(var s in n.open(t,e,i),a)n.setRequestHeader(s,a[s]);return n}function H(t){return{request:t,status:t.status,data:function(){try{var e=JSON.parse(t.responseText);return e}catch(i){return t.responseText}}()}}function N(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.async,a=void 0===i||i,n=e.headers,s=void 0===n?{}:n;return new T.a(function(e,i){var n=D("GET",t,a,s),r=function(){var t=H(n);t.success=!1,t.error=n.responseText,i(t)};n.onload=function(){if(n.status>=200&&n.status<400){var t=H(n);t.success=!0,e(t)}n.status>=400&&r(n)},n.onerror=function(){return r(n)},n.send()})}var B=i("a43d"),W=i("ce24"),q=i("bc17"),Q=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.volumeSmoothing,a=void 0===i?100:i,n=e.volumeAverage,s=void 0===n?200:n,r=e.pingDelay,o=void 0===r?2500:r,c=e.fixed,l=void 0!==c&&c,u=e.staticIntervalBaseDuration,h=void 0===u?2e3:u;Object(k["a"])(this,t);var v=$("KALEIDOSYNC_ACCESS_TOKEN"),d=$("KALEIDOSYNC_REFRESH_TOKEN"),f=$("KALEIDOSYNC_REFRESH_CODE");this.fixed=l,this.state=R({api:{currentlyPlaying:"https://api.spotify.com/v1/me/player",trackAnalysis:"https://api.spotify.com/v1/audio-analysis/",trackFeatures:"https://api.spotify.com/v1/audio-features/",tokens:{accessToken:v,refreshToken:d,refreshCode:f},headers:{Authorization:"Bearer "+v,Accept:"application/json"},pingDelay:o},intervalTypes:["tatums","segments","beats","bars","sections"],activeIntervals:R({tatums:{},segments:{},beats:{},bars:{},sections:{}}),currentlyPlaying:{},trackAnalysis:{},trackFeatures:{},initialTrackProgress:0,initialStart:0,trackProgress:0,active:!1,initialized:!1,noPlayback:!1,loadingNextSong:!1,volumeSmoothing:a,volumeAverage:s,volume:0,queues:{volume:[],beat:[]}}),this.initHooks(),!0===l?(this.state.trackAnalysis=this.buildStaticIntervals(h),this.state.trackFeatures={danceability:.5,energy:.5,key:9,loudness:-10,mode:1,speechiness:.1,acousticness:.1,instrumentalness:.5,liveness:.1,valence:.5,tempo:100.03},this.state.active=!0,requestAnimationFrame(this.tick.bind(this))):this.ping()}return Object(S["a"])(t,[{key:"initHooks",value:function(){var t=this;this.hooks={tatum:[],segment:[],beat:[],bar:[],section:[]},this.state.activeIntervals.watch("tatums",function(e){t.hooks.tatum.forEach(function(t){return t(e)})}),this.state.activeIntervals.watch("segments",function(e){t.hooks.segment.forEach(function(t){return t(e)})}),this.state.activeIntervals.watch("beats",function(e){t.hooks.beat.forEach(function(t){return t(e)})}),this.state.activeIntervals.watch("bars",function(e){t.hooks.bar.forEach(function(t){return t(e)})}),this.state.activeIntervals.watch("sections",function(e){t.hooks.section.forEach(function(t){return t(e)})})}},{key:"ping",value:function(){var t=this;setTimeout(function(){return t.getCurrentlyPlaying()},this.state.api.pingDelay)}},{key:"getNewToken",value:function(){var t=Object(z["a"])(regeneratorRuntime.mark(function t(){var e,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,N("".concat("http://localhost:8001","/refresh?token=").concat(this.state.api.tokens.refreshToken));case 3:e=t.sent,i=e.data,L(SPOTIFY_ACCESS_TOKEN,i.access_token),this.state.api.tokens.accessToken=i.access_token,this.state.api.headers={Authorization:"Bearer "+this.state.api.tokens.accessToken,Accept:"application/json"},this.ping(),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](0),window.location.href="/";case 14:case"end":return t.stop()}},t,this,[[0,11]])}));function e(){return t.apply(this,arguments)}return e}()},{key:"getCurrentlyPlaying",value:function(){var t=Object(z["a"])(regeneratorRuntime.mark(function t(){var e,i,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,N(this.state.api.currentlyPlaying,{headers:this.state.api.headers});case 3:if(e=t.sent,i=e.data,i&&i.is_playing){t.next=9;break}return!0===this.state.active&&(this.state.active=!1),!1===this.state.noPlayback&&(this.state.noPlayback=!0),t.abrupt("return",this.ping());case 9:this.processResponse(i),t.next=17;break;case 12:if(t.prev=12,t.t0=t["catch"](0),a=t.t0.status,401!==a){t.next=17;break}return t.abrupt("return",this.getNewToken());case 17:case"end":return t.stop()}},t,this,[[0,12]])}));function e(){return t.apply(this,arguments)}return e}()},{key:"processResponse",value:function(t){var e=C()(t.item)===C()(this.state.currentlyPlaying);if(!1===this.state.initialized||!e||!1===this.state.active)return this.getTrackInfo(t);this.ping()}},{key:"getTrackInfo",value:function(){var t=Object(z["a"])(regeneratorRuntime.mark(function t(e){var i,a,n,s,r,o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.state.loadingNextSong=!0,i=window.performance.now(),t.next=4,T.a.all([N(this.state.api.trackAnalysis+e.item.id,{headers:this.state.api.headers}).then(function(t){return t.data}),N(this.state.api.trackFeatures+e.item.id,{headers:this.state.api.headers}).then(function(t){return t.data})]);case 4:a=t.sent,n=Object(b["a"])(a,2),s=n[0],r=n[1],this.state.intervalTypes.forEach(function(t){var i=s[t];i[0].duration=i[0].start+i[0].duration,i[0].start=0,i[i.length-1].duration=e.item.duration_ms/1e3-i[i.length-1].start,i.forEach(function(t){t.loudness_max_time&&(t.loudness_max_time=1e3*t.loudness_max_time),t.start=1e3*t.start,t.duration=1e3*t.duration})}),o=window.performance.now()-i,this.state.currentlyPlaying=e.item,this.state.trackAnalysis=s,this.state.trackFeatures=r,this.state.initialTrackProgress=e.progress_ms+o,this.state.trackProgress=e.progress_ms+o,this.state.initialStart=window.performance.now(),this.state.loadingNextSong=!1,!1===this.state.initialized&&(requestAnimationFrame(this.tick.bind(this)),this.state.initialized=!0),!1===this.state.active&&(this.state.active=!0),!0===this.state.noPlayback&&(this.state.noPlayback=!1),this.ping();case 21:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}()},{key:"setActiveIntervals",value:function(){var t=this,e=function(e){for(var i=t.state.trackAnalysis[e],a=t.state.trackProgress,n=0;n<i.length;n++){if(n===i.length-1)return n;if(i[n].start<a&&a<i[n+1].start)return n}};this.state.intervalTypes.forEach(function(i){var a=e(i);a!==t.state.activeIntervals[i].index&&(t.state.activeIntervals[i]=Object(d["a"])({},t.state.trackAnalysis[i][a],{index:a}));var n=t.state.activeIntervals[i],s=n.start,r=n.duration,o=t.state.trackProgress-s;t.state.activeIntervals[i].elapsed=o,t.state.activeIntervals[i].progress=o/r})}},{key:"getVolume",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.activeIntervals.segments,e=t.loudness_max,i=t.loudness_start,a=t.loudness_max_time,n=t.duration,s=t.elapsed,r=t.start,o=t.index;if(!this.state.trackAnalysis.segments[o+1])return 0;var c=this.state.trackAnalysis.segments[o+1].loudness_start,l=r+s;if(s<a){var u=Math.min(1,s/a);return Object(B["c"])(i,e)(u)}var h=r+a,v=l-h,d=n-a,f=Math.min(1,v/d);return Object(B["c"])(e,c)(f)}},{key:"watch",value:function(t,e){this.state.watch(t,e)}},{key:"on",value:function(t,e){this.hooks[t].push(e)}},{key:"getInterval",value:function(t){return this.state.activeIntervals[t+"s"]}},{key:"tick",value:function(t){requestAnimationFrame(this.tick.bind(this)),this.state.trackProgress=t-this.state.initialStart+this.state.initialTrackProgress,this.setActiveIntervals();var e=this.getVolume(),i=this.state.queues;function a(t){return t.reduce(function(t,e){return t+e})/t.length}i.volume.unshift(e),i.volume.length>this.state.volumeAverage&&i.volume.pop(),i.beat.unshift(e),i.beat.length>this.state.volumeSmoothing&&i.beat.pop();var n=Object(W["b"])().domain([Object(q["d"])(i.volume),a(i.volume)]),s=a(i.beat);this.volume=n(s)}},{key:"getFutureVolume",value:function(t){var e=this.state.trackAnalysis.segments[t].loudness_start,i=Object(d["a"])({},this.state.queues);function a(t){return t.reduce(function(t,e){return t+e})/t.length}i.volume.unshift(e),i.volume.length>this.state.volumeAverage&&i.volume.pop(),i.beat.unshift(e),i.beat.length>this.state.volumeSmoothing&&i.beat.pop();var n=Object(W["b"])().domain([Object(q["d"])(i.volume),a(i.volume)]),s=a(i.beat);return n(s)}},{key:"buildStaticIntervals",value:function(t){var e={},i={beats:t,tatums:[t*(2/3),t*(1/3)],segments:t/2,sections:16*t,bars:4*t},a=["tatums","segments","beats","bars","sections"];return a.forEach(function(t){e[t]=[];for(var a=0;a<1e4;a++){var n=e.tatums[a-1]?Math.round(e.tatums[a-1].start+e.tatums[a-1].duration):0,s=a%2===0?Math.round(i.tatums[0]):Math.round(i.tatums[1]);e[t].push({start:"tatums"===t?n:a*i[t],duration:"tatums"===t?s:i[t],loudness_start:a/1e4*20-30,loudness_max:a/1e4*20-25,loudness_max_time:.5*i[t]})}}),e}},{key:"isActive",get:function(){return!0===this.state.active}},{key:"tatum",get:function(){return this.state.activeIntervals.tatums}},{key:"segment",get:function(){return this.state.activeIntervals.segments}},{key:"beat",get:function(){return this.state.activeIntervals.beats}},{key:"bar",get:function(){return this.state.activeIntervals.bars}},{key:"section",get:function(){return this.state.activeIntervals.sections}}]),t}();var G=function(){function t(){var e=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=i.main,n=void 0===a?null:a,s=i.container,r=void 0===s?document.body:s,o=i.width,c=void 0===o?window.innerWidth:o,l=i.height,u=void 0===l?window.innerHeight:l,h=i.hidpi,v=void 0===h||h,d=i.fill,f=void 0===d?null:d,m=i.name;Object(k["a"])(this,t),this.container=r,this.width=c,this.height=u,this.hidpi=v,this.active=!1,this.queue=[],this.fill=f,this.canvas=document.createElement("canvas"),this.canvas.setAttribute("id",m),this.ctx=this.canvas.getContext("2d"),this.container.appendChild(this.canvas),this.setSize(),c===window.innerWidth&&u==window.innerHeight&&window.addEventListener("resize",function(){e.width=window.innerWidth,e.height=window.innerHeight,e.setSize()}),this.mouse={x:0,y:0},this.canvas.addEventListener("mousemove",function(t){var i=t.pageX,a=t.pageY;e.mouse={x:i,y:a}}),null!==n&&this.add("main",n)}return Object(S["a"])(t,[{key:"setSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=(null!==t?t:this.hidpi)?Math.min(window.devicePixelRatio,2):1;this.canvas.width=this.width*e,this.canvas.height=this.height*e,this.canvas.style.width=this.width+"px",this.canvas.style.height=this.height+"px",this.ctx.scale(e,e)}},{key:"add",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.queue.push({name:t,method:e,duration:i,start:window.performance.now()})}},{key:"remove",value:function(t){this.queue=this.queue.filter(function(e){return e.name!==t})}},{key:"start",value:function(){!0!==this.active&&(this.active=!0,requestAnimationFrame(this.loop.bind(this)))}},{key:"stop",value:function(){!1!==this.active&&(this.active=!1,cancelAnimationFrame(this.loop.bind(this)))}},{key:"paint",value:function(t,e){var i=e.name,a=e.start,n=e.duration,s=e.method,r=t-a,o="number"===typeof n?Math.min(r/n,1):null,c={ctx:this.ctx,width:this.width,height:this.height,largest:this.width>this.height?this.width:this.height,smallest:this.width>this.height?this.height:this.width,now:t,progress:o,duration:n,elapsed:r,start:a,mouse:this.mouse};this.fill&&(this.ctx.save(),this.ctx.globalCompositeOperation="source-over",this.ctx.fillStyle=this.fill,this.ctx.fillRect(0,0,this.width,this.height),this.ctx.restore()),s(c),1===o&&this.remove(i)}},{key:"loop",value:function(t){var e=this;!0===this.active&&requestAnimationFrame(this.loop.bind(this)),this.queue.forEach(function(i){return e.paint(t,i)})}}]),t}(),U=function(){function t(e){var i=e.volumeSmoothing,a=void 0===i?100:i,n=e.volumeAverage,s=void 0===n?400:n,r=e.width,o=void 0===r?window.innerWidth:r,c=e.height,l=void 0===c?window.innerHeight:c,u=e.hidpi,h=void 0===u||u,v=e.container,d=void 0===v?document.body:v,f=e.fixed,m=void 0!==f&&f,g=e.staticIntervalBaseDuration,b=e.syncOnly,p=void 0!==b&&b,y=e.parent,w=void 0===y?null:y,S=e.name,O=void 0===S?"":S,x=e.staticFactory,_=void 0===x?function(t){return t}:x;if(Object(k["a"])(this,t),w)return this.sync=w.sync,this.sketch=w.sketch,this.hooks();this.sync=new Q({volumeSmoothing:a,fixed:m,staticIntervalBaseDuration:g,staticFactory:_,volumeAverage:s}),!1===p&&(this.sketch=new G({main:this.paint.bind(this),hidpi:h,width:o,height:l,container:d,name:O}),this.watch()),this.hooks(),!1===p&&this.sync.fixed&&this.sketch.start()}return Object(S["a"])(t,[{key:"watch",value:function(){var t=this;this.sync.watch("active",function(e){!0===e?t.sketch.start():t.sketch.stop()})}},{key:"hooks",value:function(){}},{key:"paint",value:function(){}}]),t}();function K(t){return t[Math.floor(Math.random()*t.length)]}var Y=Math.PI,Z=Y/2;function J(t){return Y*t/180}function X(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return{x:t*Math.cos(e)+i,y:t*Math.sin(e)+a}}function tt(t,e){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=360/t,r=[],o=0;o<t;o++){var c=X(e,J(s*o+n),i,a);r.push(c)}return r}function et(t,e,i){for(var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,r=tt(t,i,a,n,s),o=tt(t,e,a,n,360/t/2+s),c=[],l=0;l<t;l++)c.push({x:r[l].x,y:r[l].y}),c.push({x:o[l].x,y:o[l].y});return{outer:r,inner:o,vertices:c}}function it(t,e){return e.forEach(function(e,i){var a=e.x,n=e.y;0===i?(t.beginPath(),t.moveTo(a,n)):t.lineTo(a,n)}),t.closePath(),t}function at(t,e,i,a,n,s,r){var o=Math.atan2(n-i,a-e)+Z;return t.beginPath(),t.arc(e,i,s/2,o,o+Y),t.arc(a,n,r/2,o+Y,o),t.closePath(),t}var nt={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*t*t:(4-2*t)*t-1},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return--t*t*t+1},easeInOutCubic:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1- --t*t*t*t},easeInOutQuart:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1+--t*t*t*t*t},easeInOutQuint:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}};function st(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"easeInOutQuart",i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!nt[e])throw new Error('Unknown easing function "'.concat(e,'"'));var a=nt[e](t);return!0===i?(t+t+a)/3:a}var rt=function(t){function e(t){var i;return Object(k["a"])(this,e),i=Object(O["a"])(this,Object(x["a"])(e).call(this,w()({volumeSmoothing:10,hidpi:!1,name:"kaleidosync"},t))),i.state=R({easing:"easeOutQuint",totalStars:28,minSize:0,maxSize:0,activeSize:0,radiusStep:[.1,.2,.3,.8,1,1.1],sizeStep:[],colorThemes:[[[255,255,255],[255,191,105],[255,159,28],[203,243,240],[46,196,182]],[[229,99,153],[210,241,228],[251,202,239],[72,48,77],[255,255,255]],[[198,0,66],[255,119,168],[226,206,239],[255,198,217],[255,255,255]],[[118,229,252],[27,154,170],[157,172,255],[61,52,139],[238,251,255]],[[10,36,99],[62,146,204],[255,250,255],[216,49,91],[39,27,24]]],activeColorTheme:{},negativeSpace:20,stars:[],background:{}}),i.setSizeParams(),i.setInitialModel(),window.addEventListener("resize",function(){i.setSizeParams()}),i}return Object(_["a"])(e,t),Object(S["a"])(e,[{key:"setSizeParams",value:function(){var t=this.sketch.height<this.sketch.width;this.state.maxSize=t?this.sketch.width/2:this.sketch.height/2,this.state.minSize=this.state.maxSize/10,this.state.activeSize=this.state.maxSize;var e=this.state,i=e.maxSize,a=e.totalStars;this.state.sizeStep=Object(p["a"])(this.state.radiusStep).map(function(t){return i/a*t})}},{key:"setInitialModel",value:function(){var t=this;if(!0!==this.sync.state.initialized){this.setColorTheme();for(var e=this.state.activeSize,i=0;i<this.state.totalStars;i++){var a=8;(i+1)%2===0&&(a=16),(i+1)%3===0&&(a=24),e=~~(e-K(this.state.sizeStep)),e<this.state.minSize&&(e=this.state.minSize);var n=i===this.state.totalStars-1?this.state.activeColorTheme.negative:K(this.state.activeColorTheme.theme);this.addStar({points:a,color:n,size:e})}this.state.background={last:this.state.activeColorTheme.negative,next:this.state.activeColorTheme.negative,interval:{},get:function(){return t.state.activeColorTheme.negative}}}}},{key:"setColorTheme",value:function(){var t=Object(p["a"])(K(this.state.colorThemes)),e=K(t),i=t.filter(function(t){return t!==e}),a=K(i),n=0;while(n<this.state.negativeSpace)t.push(e),n++;this.state.activeColorTheme={theme:t,negative:e,primary:a}}},{key:"addStar",value:function(t){var e=t.points,i=t.color,a=t.size,n=this.sketch.width/2,s=this.sketch.height/2,r=a,o=a*K(this.state.radiusStep),c=0,l={x:n,y:s,points:e,outerRadius:{last:r,next:r,interval:{},get:function(){return r}},innerRadius:{last:o,next:o,interval:{},get:function(){return o}},color:{last:i,next:i,interval:{},get:function(){return i}},startVolume:{last:c,next:c,interval:{},get:function(){return c}},lineWidth:{last:0,next:0,interval:{},get:function(){return 0}}};this.state.stars.push(l)}},{key:"setStarRadius",value:function(t){var e,i=this,a=this.sync.state.trackAnalysis.segments[this.sync.segment.index+1];e=a?this.state.activeSize*this.sync.getFutureVolume(this.sync.segment.index+1):this.state.activeSize*this.sync.volume,this.state.stars.forEach(function(a,n){e=~~(e-K(i.state.sizeStep)),e<i.state.minSize&&(e=i.state.minSize);var s={val:n===i.state.stars.length-1?.8*e:e*K(i.state.radiusStep),interval:t},r={val:e,interval:t};i.updateStar({innerRadius:s,outerRadius:r,index:n})})}},{key:"setStarColor",value:function(t){var e=this;this.state.stars.forEach(function(i,a){var n=a===e.state.totalStars-1?e.state.activeColorTheme.negative:K(e.state.activeColorTheme.theme);e.updateStar({color:{val:n,interval:t},index:a})})}},{key:"updateStar",value:function(t){var e=this,i=t.index,a=t.innerRadius,n=void 0===a?null:a,s=t.outerRadius,r=void 0===s?null:s,o=t.color,c=void 0===o?null:o,l=t.points,u=void 0===l?null:l,h=this.state.stars[i],v=function(t,i){var a=i.val,n=i.interval;h[t].last=h[t].next,h[t].next=a,h[t].interval=n,h[t].get=function(){return Object(B["a"])(h[t].last,h[t].next)(st(e.sync[n].progress,e.state.easing,!0))}};null!==c&&v("color",c),null!==n&&v("innerRadius",n),null!==r&&v("outerRadius",r),null!==u&&(h.points=u)}},{key:"setBackgroundColor",value:function(t){var e=this,i=Object(p["a"])(this.state.activeColorTheme.negative);this.state.background.last=Object(p["a"])(this.state.background.next),this.state.background.next=i,this.state.background.get=function(){return Object(B["a"])(e.state.background.last,e.state.background.next)(e.sync[t].progress)}}},{key:"hooks",value:function(){var t=this;this.sync.on("tatum",function(){t.setStarRadius("tatum")}),this.sync.on("beat",function(){t.setStarColor("beat"),t.setBackgroundColor("beat")}),this.sync.on("bar",function(e){var i=e.index;i%4===0&&t.setColorTheme()})}},{key:"paint",value:function(t){var e=t.ctx,i=t.height,a=t.width,n=t.now,s=this.state.background.get(),r=Object(b["a"])(s,3),o=r[0],c=r[1],l=r[2];e.fillStyle="rgb(".concat(o,",").concat(c,",").concat(l,")"),e.fillRect(0,0,a,i);var u=!0,h=!1,v=void 0;try{for(var d,f=g()(this.state.stars);!(u=(d=f.next()).done);u=!0){var m=d.value,p=m.innerRadius.get(),y=m.outerRadius.get(),w=n/40,k=et(m.points,p,y,a/2,i/2,w),S=k.vertices,O=m.color.get(),x=Object(b["a"])(O,3),_=x[0],j=x[1],T=x[2];e.fillStyle="rgb(".concat(_,",").concat(j,",").concat(T,")"),it(e,S).fill()}}catch(A){h=!0,v=A}finally{try{u||null==f.return||f.return()}finally{if(h)throw v}}}}]),e}(U),ot=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 120.78 117.79"}},[i("path",{style:{fill:t.color,transition:"all "+t.colorTransitionDuration+"ms"},attrs:{d:"M60.39,0A60.39,60.39,0,0,0,41.3,117.69c3,.56,4.12-1.31,4.12-2.91,0-1.44-.05-6.19-.08-11.24C28.54,107.19,25,96.42,25,96.42c-2.75-7-6.71-8.84-6.71-8.84-5.48-3.75.41-3.67.41-3.67,6.07.43,9.26,6.22,9.26,6.22,5.39,9.23,14.13,6.57,17.57,5,.55-3.9,2.11-6.56,3.84-8.07C36,85.55,21.85,80.37,21.85,57.23A23.35,23.35,0,0,1,28.08,41c-.63-1.52-2.7-7.66.58-16,0,0,5.07-1.62,16.61,6.19a57.36,57.36,0,0,1,30.25,0C87,23.42,92.11,25,92.11,25c3.28,8.32,1.22,14.46.59,16a23.34,23.34,0,0,1,6.21,16.21c0,23.2-14.12,28.3-27.57,29.8,2.16,1.87,4.09,5.55,4.09,11.18,0,8.08-.06,14.59-.06,16.57,0,1.61,1.08,3.49,4.14,2.9A60.39,60.39,0,0,0,60.39,0Z"}}),i("path",{style:{fill:t.color,transition:"all "+t.colorTransitionDuration+"ms"},attrs:{d:"M22.87,86.7c-.13.3-.6.39-1,.19s-.69-.61-.55-.91.61-.39,1-.19.69.61.54.91Z"}}),i("path",{style:{fill:t.color,transition:"all "+t.colorTransitionDuration+"ms"},attrs:{d:"M25.32,89.43c-.29.27-.85.14-1.24-.28a.92.92,0,0,1-.17-1.25c.3-.27.84-.14,1.24.28s.47,1,.17,1.25Z"}}),i("path",{style:{fill:t.color,transition:"all "+t.colorTransitionDuration+"ms"},attrs:{d:"M27.7,92.91c-.37.26-1,0-1.35-.52s-.37-1.18,0-1.44,1,0,1.35.51.37,1.19,0,1.45Z"}}),i("path",{style:{fill:t.color,transition:"all "+t.colorTransitionDuration+"ms"},attrs:{d:"M31,96.27A1.13,1.13,0,0,1,29.41,96c-.53-.49-.68-1.18-.34-1.54s1-.27,1.56.23.68,1.18.33,1.54Z"}}),i("path",{style:{fill:t.color,transition:"all "+t.colorTransitionDuration+"ms"},attrs:{d:"M35.46,98.22c-.15.47-.82.69-1.51.49s-1.13-.76-1-1.24.82-.7,1.51-.49,1.13.76,1,1.24Z"}}),i("path",{style:{fill:t.color,transition:"all "+t.colorTransitionDuration+"ms"},attrs:{d:"M40.4,98.58c0,.5-.56.91-1.28.92s-1.3-.38-1.31-.88.56-.91,1.29-.92,1.3.39,1.3.88Z"}}),i("path",{style:{fill:t.color,transition:"all "+t.colorTransitionDuration+"ms"},attrs:{d:"M45,97.8c.09.49-.41,1-1.12,1.12s-1.35-.17-1.44-.66.42-1,1.12-1.12,1.35.17,1.44.66Z"}})])},ct=[],lt={props:["color","colorTransitionDuration"]},ut=lt,ht=Object(r["a"])(ut,ot,ct,!1,null,null,null),vt=ht.exports,dt="SET_MENU_VISIBLE",ft="SER_VISUALIZER",mt="SET_ALBUM_ART_VISIBLE",gt="SET_TRACK_INFO_VISIBLE",bt="SET_ALWAYS_SHOW_TRACK_INFO",pt="SET_ALWAYS_SHOW_ALBUM_ART",yt="SET_HOVER",wt="SET_HOVER_TIMEOUT",kt="SET_TOAST_VISIBLE",St="SET_TOAST_MESSAGE",Ot="SET_COLOR",xt="SET_SPINNER_VISIBLE",_t="SET_CURRENTLY_PLAYING",jt="SET_HIDE_ALL",Tt={name:"home",components:{GitHub:vt},data:function(){return{hide:!1}},computed:Object(d["a"])({},Object(f["b"])(["color","colorTransitionDuration"])),methods:{login:function(){var t=this;this.hide=!0,this.kaleidosync.sketch.canvas.classList.add("fade-out"),this.$refs.last.addEventListener("animationend",function(){t.$store.dispatch("login")})}},created:function(){var t=this;this.kaleidosync=new rt({fixed:!0,hidpi:!0,volumeSmoothing:30}),this.kaleidosync.sketch.canvas.classList.add("fade"),this.kaleidosync.state.watch("activeColorTheme",function(e,i){e.primary!==i.primary&&t.$store.commit(Ot,e.primary)}),this.$store.commit(Ot,this.kaleidosync.state.activeColorTheme.primary)},mounted:function(){this.$ga&&this.$ga.page("/")}},At=Tt,Ct=(i("ae3c"),i("fd42"),Object(r["a"])(At,h,v,!1,null,"241da39e",null)),zt=Ct.exports,It=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"visualizer"},[i("Hamburger"),i("transition",{attrs:{name:"fadeyn"}},[t.menuVisible?i("Header"):t._e()],1),i("NowPlaying"),i("transition",{attrs:{name:"fade"}},[t.spinnerVisible?i("Spinner"):t._e()],1),i("transition",{attrs:{name:"fadey"}},[t.toast.visible?i("Toast"):t._e()],1)],1)},Et=[],Mt=i("013f"),Pt=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=i.parent,n=void 0===a?null:a,s=i.fixed,r=void 0!==s&&s,o=i.volumeSmoothing,c=void 0===o?30:o;Object(k["a"])(this,e),t=Object(O["a"])(this,Object(x["a"])(e).call(this,{volumeSmoothing:c,hidpi:!0,parent:n,fixed:r,name:"trails"})),t.SIDES=9,t.TRAIL_LENGTH=30,t._01=[],t._02=[],t._03=[];for(var l=0;l<t.SIDES;l++)t._01.push([]),t._02.push([]),t._03.push([]);return t.theme=["#FF4242","#18FF2A","#7718FF","#FF4242"],t.iTheme=Object(B["d"])(t.theme),t.beat=Object(B["b"])([-100,100,-100]),t.bar=Object(B["b"])([-500,500,-500]),t}return Object(_["a"])(e,t),Object(S["a"])(e,[{key:"drawLine",value:function(t,e,i){for(var a=0;a<e.length-1;a++){var n=a/(e.length-1),s=(a+1)/(e.length-1),r=Object(B["b"])([0,i,0])(n),o=Object(B["b"])([0,i,0])(s);t.fillStyle=this.iTheme(n),at(t,e[a].x,e[a].y,e[a+1].x,e[a+1].y,r,o),t.fill()}}},{key:"update",value:function(t,e){var i=this;t.forEach(function(t,a){var n=t.x,s=t.y;i[e][a].push({x:n,y:s}),i[e][a].length>i.TRAIL_LENGTH&&i[e][a].shift()})}},{key:"paint01",value:function(t){var e=t.ctx,i=t.width,a=t.height,n=t.now,s=t.smallest,r=st(this.sync.bar.progress,"easeInOutQuint"),o=Object(B["b"])([-s*(5/8),s*(5/8),-s*(5/8)])(r)*this.sync.volume,c=Math.pow(this.sync.volume,2)*(s/2)+o,l=tt(this.SIDES,c,i/2,a/2,n/20);this.update(l,"_01");for(var u=this._01.length-1;u>=0;u--)this.drawLine(e,this._01[u],s/50*this.sync.volume)}},{key:"paint02",value:function(t){var e=t.ctx,i=t.width,a=t.height,n=t.now,s=t.smallest,r=Object(B["b"])([-s/8,s/8,-s/8])(st(this.sync.beat.progress,"easeOutQuint")),o=Math.pow(this.sync.volume,2)*s/3+r,c=tt(Math.round(this.SIDES/2),o,i/2,a/2,n/-10);this.update(c,"_02");for(var l=this._02.length-1;l>=0;l--)this.drawLine(e,this._02[l],s/32*this.sync.volume)}},{key:"paint03",value:function(t){var e=t.ctx,i=t.width,a=t.height,n=t.now,s=t.smallest,r=Object(B["b"])([-s/8,s/8,-s/8])(st(this.sync.beat.progress,"easeOutQuint")),o=Math.pow(this.sync.volume,2)*s/4+r,c=tt(this.SIDES,o,i/2,a/2,n/15);this.update(c,"_03");for(var l=this._03.length-1;l>=0;l--)this.drawLine(e,this._03[l],s/50*this.sync.volume)}},{key:"paint",value:function(t){this.sketch.fill="rgba(0, 0, 0, 1)";var e=this.beat();this.paint01(t),this.paint02(t,e),this.paint03(t,e)}}]),e}(U),Ft=i("482f"),Vt=2*Math.PI,Rt=Math.PI/180,$t=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=i.fixed,n=void 0!==a&&a,s=i.parent,r=void 0===s?null:s,o=i.volumeSmoothing,c=void 0===o?80:o;return Object(k["a"])(this,e),t=Object(O["a"])(this,Object(x["a"])(e).call(this,{volumeSmoothing:c,fixed:n,hidpi:!1,name:"wavesync",parent:r})),t.theme=[Object(Ft["a"])("#FFE66D"),Object(Ft["a"])("#4ECDC4"),Object(Ft["a"])("#FF6B6B"),Object(Ft["a"])("#292F36")],t.overlayColors=[Object(Ft["a"])("#18FF2A"),Object(Ft["a"])("#7718FF"),Object(Ft["a"])("#06C5FE"),Object(Ft["a"])("#FF4242"),Object(Ft["a"])("#18FF2A")].map(function(t){var e=t.r,i=t.g,a=t.b;return"rgba(".concat(e,", ").concat(i,", ").concat(a,", 1)")}),t.easing="easeInOutQuint",t.setGradients(),t.setCtxParams(),t.setScales(),t.watch(),window.addEventListener("resize",function(){t.setGradients(),t.setCtxParams()}),t}return Object(_["a"])(e,t),Object(S["a"])(e,[{key:"setGradients",value:function(){var t=this.sketch.height>this.sketch.width?this.sketch.height/2:this.sketch.width/2,e={x:this.sketch.width/2,y:this.sketch.height/2};this.gradient=this.sketch.ctx.createRadialGradient(e.x,e.y,0,e.x,e.y,t),this.gradient.addColorStop(0,this.theme[0]),this.gradient.addColorStop(.5,this.theme[1]),this.gradient.addColorStop(1,this.theme[0]),this.gradient2=this.sketch.ctx.createRadialGradient(e.x,e.y,0,e.x,e.y,t/3),this.gradient2.addColorStop(0,this.theme[0]),this.gradient2.addColorStop(.5,this.theme[1]),this.gradient2.addColorStop(1,this.theme[0]),this.gradient3=this.sketch.ctx.createRadialGradient(e.x,e.y,0,e.x,e.y,t),this.gradient3.addColorStop(0,this.theme[2]),this.gradient3.addColorStop(1,this.theme[0])}},{key:"setCtxParams",value:function(){this.sketch.ctx.lineCap="round",this.sketch.ctx.lineJoin="round"}},{key:"setScales",value:function(){this.rotationScale=Object(W["a"])().domain([0,1]).range([3e3,1200]),this.radiusScale=Object(W["a"])().domain([0,.3,.6,1]).range([.5,1,1.1,1.2]),this.smoothingScale=Object(W["a"])().domain([0,1]).range([100,30])}},{key:"createPath",value:function(t,e){var i=e.x,a=e.y,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;t.beginPath();for(var s=0;s<n*Vt;s+=Rt){var r=i(s),o=a(s);0===s?t.moveTo(r,o):t.lineTo(r,o)}}},{key:"paintBackground",value:function(t){var e=t.ctx,i=t.width,a=t.height;this.sketch.ctx.fillStyle=this.gradient3,e.fillRect(0,0,i,a)}},{key:"paintOuterLines",value:function(t){var e=this,i=t.ctx,a=t.width,n=t.height,s=t.now,r=st(this.sync.beat.progress,this.easing),o=a>n?a/10:n/10,c=this.sync.volume,l=Object(B["b"])([c*-o,c*o,c*-o]),u=l(r)*this.radiusScale(this.sync.state.trackFeatures.energy)*.66,h=a>n?c*n/3:c*a/3,v=function(t){return(h+u*Math.sin(7*(t+s/e.rotationScale(e.sync.state.trackFeatures.energy))))*Math.tan(t)+a/2},d=function(t){return(h+u*Math.sin(7*(t+s/e.rotationScale(e.sync.state.trackFeatures.energy)/2)))*Math.cos(t)+n/2};this.createPath(i,{x:v,y:d}),i.lineWidth=5*c,i.strokeStyle=this.gradient,i.stroke(),i.fillRect(0,n/2-20*c,a,40*c)}},{key:"paintInnerLines",value:function(t){var e=this,i=t.ctx,a=t.width,n=t.height,s=t.now,r=st(this.sync.bar.progress,this.easing),o=this.sync.volume,c=Object(B["b"])([o*(n/5),o*(n/5)])(r),l=a>n?o*n/3:o*a/3,u=function(t){return(l+c*Math.sin(2.019*(t+s/e.rotationScale(e.sync.state.trackFeatures.energy)*8)))*Math.cos(t)+a/2},h=function(t){return(l+c*Math.sin(2.019*(t+s/e.rotationScale(e.sync.state.trackFeatures.energy)*4)))*Math.sin(t)+n/2};this.createPath(i,{x:u,y:h},15),i.lineWidth=Math.min(o,1),i.strokeStyle=this.gradient2,i.stroke()}},{key:"paintCenter",value:function(t){var e=this,i=t.ctx,a=t.width,n=t.height,s=t.now,r=st(this.sync.beat.progress,this.easing),o=a<n?a/5:n/5,c=this.sync.volume,l=Object(B["b"])([c*-o,c*o,c*-o]),u=l(r)*this.radiusScale(this.sync.state.trackFeatures.energy),h=a>n?c*n/3:c*a/3,v=function(t){return(h+.5*u*Math.sin(7*(t+s/e.rotationScale(e.sync.state.trackFeatures.energy)*4)))*Math.cos(t)+a/2},d=function(t){return(h+.5*u*Math.sin(7*(t+s/e.rotationScale(e.sync.state.trackFeatures.energy))))*Math.sin(t)+n/2},f=Object(B["b"])([c*(a>n?a:n)/30,c,c*(a>n?a:n)/30]);this.createPath(i,{x:v,y:d}),i.lineWidth=f(st(this.sync.beat.progress,"linear")),i.strokeStyle=this.gradient,i.stroke()}},{key:"paintOverlay",value:function(t){var e=t.ctx,i=t.width,a=t.height,n=t.now;this.backgroundTick||(this.backgroundTick=n);var s=Math.min((n-this.backgroundTick)/1e4,1);e.save(),e.globalCompositeOperation="overlay",e.fillStyle=Object(B["d"])(this.overlayColors)(s),e.fillRect(0,0,i,a),e.restore(),1===s&&(this.backgroundTick=n)}},{key:"paint",value:function(t){this.setCtxParams(),this.paintBackground(t),this.paintOuterLines(t),this.paintInnerLines(t),this.paintCenter(t),this.paintOverlay(t)}}]),e}(U);function Lt(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=Math.random()*e+t;return!0===i?Math.round(a):a}var Dt=2*Math.PI,Ht=[Object(Ft["a"])("#FF8360"),Object(Ft["a"])("#00FFF5"),Object(Ft["a"])("#D84797"),Object(Ft["a"])("#292F36")];function Nt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=Ht[t],a=i.r,n=i.g,s=i.b;return"rgba(".concat(a,", ").concat(n,", ").concat(s,", ").concat(e,")")}var Bt=function(){function t(e,i,a){Object(k["a"])(this,t),this.self=i,this.interval=e,this.birth=window.performance.now(),this.lifespan=e.duration,this.color=a,this.width=window.innerWidth/5*Math.pow(i.sync.volume,2)}return Object(S["a"])(t,[{key:"paint",value:function(t){var e=this,i=t.ctx,a=t.width,n=t.height,s=t.now,r=80,o=80,c=2500,l=3,u=5,h=3,v=.02,d="easeOutQuart",f=Math.max(Math.min((s-this.birth)/(this.lifespan*l),1),0);if(1===f)return this.self.circles=this.self.circles.filter(function(t){return t!==e});var m=Object(B["c"])(0,this.width),g=Object(B["b"])([0,this.width/r,0]),b=Object(B["b"])([1,o,1])(st(this.self.sync.beat.progress,d)),p=m(f),y=Object(B["b"])([-p/2,p,-p/2])(st(this.self.sync.beat.progress,d)),w=s/c;i.save(),i.lineCap="round",i.lineJoin="round",i.beginPath();for(var k=0;k<=Dt+v;k+=v){var S=(p+y*Math.sin(u*(k-w)))*Math.cos(k)+a/2,O=(p+y*Math.sin(u*(k+w)))*Math.sin(k)+n/2;0===k?i.moveTo(S,O):i.lineTo(S,O)}i.closePath(),i.strokeStyle=this.color,i.lineWidth=g(f)*b,i.shadowBlur=i.lineWidth*h,i.shadowColor=this.color,i.globalCompositeOperation="lighter",i.stroke(),i.restore()}}]),t}(),Wt=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=i.parent,n=void 0===a?null:a,s=i.volumeSmoothing,r=void 0===s?80:s;return Object(k["a"])(this,e),t=Object(O["a"])(this,Object(x["a"])(e).call(this,{volumeSmoothing:r,hidpi:!0,parent:n})),t.circles=[],t}return Object(_["a"])(e,t),Object(S["a"])(e,[{key:"hooks",value:function(){var t=this;this.sync.on("tatum",function(e){var i=Lt(0,2,!0),a=Nt(i),n=new Bt(e,t,a);t.circles.push(n)})}},{key:"paint",value:function(t){var e=t.width,i=t.height,a=t.now,n=t.ctx;this.sketch.fill=Nt(3,.8);for(var s=this.circles.length-1;s>=0;s--)this.circles[s].paint({width:e,height:i,now:a,ctx:n})}}]),e}(U),qt=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"kaleidosync";return Object(k["a"])(this,e),t=Object(O["a"])(this,Object(x["a"])(e).call(this,{hidpi:window.innerWidth*window.innerHeight<=36e4})),t.selectedVisualizer=i,t.kaleidosync=new rt({parent:Object(Mt["a"])(t)}),t.trails=new Pt({parent:Object(Mt["a"])(t)}),t.wavesync=new $t({parent:Object(Mt["a"])(t)}),t.blobs=new Wt({parent:Object(Mt["a"])(t)}),t}return Object(_["a"])(e,t),Object(S["a"])(e,[{key:"paint",value:function(t){"trails"===this.selectedVisualizer&&this.trails.paint(t),"kaleidosync"===this.selectedVisualizer&&this.kaleidosync.paint(t),"wavesync"===this.selectedVisualizer&&this.wavesync.paint(t),"blobs"===this.selectedVisualizer&&this.blobs.paint(t)}}]),e}(U),Qt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"now-playing"},[i("transition",{attrs:{name:"fadeslide"}},[t.image.length>0&&(t.albumArtVisible||t.alwaysShowAlbumArt)&&!t.settingsVisible&&!t.toast.visible&&!t.hideAll?i("img",{attrs:{src:t.image}}):t._e()]),i("transition",{attrs:{name:"fade"}},[t.settingsVisible||t.toast.visible||t.hideAll||!t.trackInfoVisible&&!t.alwaysShowTrackInfo?t._e():i("div",{class:{transitioning:t.transitioning,initialized:t.initialized}},[i("span",{staticClass:"name"},[t.name?i("span",{style:{transition:"opacity "+t.colorTransitionDuration+"ms"}},[t._v(t._s(t.name))]):t._e()]),i("br"),i("span",{staticClass:"artist"},[t.artist?i("span",{style:{transition:"opacity "+t.colorTransitionDuration+"ms"}},[t._v(t._s(t.artist))]):t._e()])])])],1)},Gt=[],Ut={data:function(){return{delay:4e3,transitioning:!1,initialized:!1,transitionendIndex:0,image:"",name:"",artist:""}},computed:Object(d["a"])({},Object(f["b"])(["color","colorTransitionDuration","currentlyPlaying","albumArtVisible","alwaysShowAlbumArt","trackInfoVisible","alwaysShowTrackInfo","toast","settingsVisible","hover","hideAll"])),watch:{currentlyPlaying:{handler:function(t,e){var i=this.getCurrentlyPlaying(t);this.image=i.image,this.artist=i.artist,this.name=i.name,this.show(t,e)},immediate:!0}},methods:{show:function(t,e){var i=this;this.$store.commit(mt,!0),this.$store.commit(gt,!0),e&&(this.timeout=setTimeout(function(){!1===i.alwaysShowAlbumArt&&i.$store.commit(mt,!1),!1===i.alwaysShowTrackInfo&&i.$store.commit(gt,!1)},this.delay))},getCurrentlyPlaying:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentlyPlaying,e=t.name||!1,i=t.album,a=!!i&&i.images[1].url,n=i?i.artists[0].name:"";return{name:e,image:a,artist:n}}}},Kt=Ut,Yt=(i("a2ac"),Object(r["a"])(Kt,Qt,Gt,!1,null,"78d74959",null)),Zt=Yt.exports,Jt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"spinner"},[i("div",{staticClass:"loader",style:{backgroundColor:t.color}})])},Xt=[],te={computed:Object(d["a"])({},Object(f["b"])(["color"]))},ee=te,ie=(i("d995"),Object(r["a"])(ee,Jt,Xt,!1,null,"5ecd4bf8",null)),ae=ie.exports,ne=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"toast"},[i("h2",[t._v(t._s(t.message))])])},se=[],re={data:function(){return{delay:2e3}},computed:Object(d["a"])({},Object(f["b"])({message:function(t){return t.toast.message},autoHide:function(t){return t.toast.autoHide}})),mounted:function(){var t=this;this.$store.commit(yt,!1),!0===this.autoHide&&setTimeout(function(){t.$store.commit(kt,!1)},this.delay)}},oe=re,ce=(i("bfcb"),Object(r["a"])(oe,ne,se,!1,null,"3c4cd7dc",null)),le=ce.exports,ue=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container"},[i("transition",{attrs:{name:"fadeyn"}},[t.menuVisible||t.hover?i("div",{staticClass:"hamburger-container",class:{open:t.open},on:{click:t.toggleMenu}},[i("div",{staticClass:"hamburger"},[i("div",{staticClass:"inner"}),i("div",{staticClass:"inner"})])]):t._e()]),i("transition",{attrs:{name:"fadeyn"}},[!t.menuVisible&&t.hover&&t.offerFullscreen?i("button",{staticClass:"fullscreen",on:{click:t.fullScreen}},[i("svg",{attrs:{viewBox:"0 0 482.239 482.239",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"m0 17.223v120.56h34.446v-103.337h103.337v-34.446h-120.56c-9.52 0-17.223 7.703-17.223 17.223z"}}),i("path",{attrs:{d:"m465.016 0h-120.56v34.446h103.337v103.337h34.446v-120.56c0-9.52-7.703-17.223-17.223-17.223z"}}),i("path",{attrs:{d:"m447.793 447.793h-103.337v34.446h120.56c9.52 0 17.223-7.703 17.223-17.223v-120.56h-34.446z"}}),i("path",{attrs:{d:"m34.446 344.456h-34.446v120.56c0 9.52 7.703 17.223 17.223 17.223h120.56v-34.446h-103.337z"}})])]):t._e()])],1)},he=[],ve={data:function(){return{open:!1,offerFullscreen:!1,isFullscreen:!1}},computed:Object(d["a"])({},Object(f["b"])(["menuVisible","hover"])),methods:{toggleMenu:function(){this.open=!this.open,this.$store.commit(dt,this.open)},fullScreen:function(){this.isFullscreen?document.exitFullscreen():document.body.requestFullscreen()}},created:function(){var t=this;!0===document.fullscreenEnabled&&(this.offerFullscreen=!0,document.onfullscreenchange=function(){t.isFullscreen=document.fullscreen},this.isFullscreen=document.fullscreen)},beforeDestroy:function(){document.onfullscreenchange=function(){}}},de=ve,fe=(i("8876"),Object(r["a"])(de,ue,he,!1,null,"7269eb02",null)),me=fe.exports,ge=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("header",[a("h1",[t._v("Kaleidosync")]),a("div",{staticClass:"visualizers"},[a("ul",{attrs:{"data-selected":t.selectedVisualizer}},[a("li",[a("span",{staticClass:"kaleidosync",on:{click:function(e){return t.select("kaleidosync")}}},[a("img",{attrs:{src:i("754d"),alt:"Original"}})])]),a("li",[a("span",{staticClass:"blobs",on:{click:function(e){return t.select("blobs")}}},[a("img",{attrs:{src:i("1f6d"),alt:"Blobs"}})])]),a("li",[a("span",{staticClass:"trails",on:{click:function(e){return t.select("trails")}}},[a("img",{attrs:{src:i("1fbc"),alt:"Trails"}})])]),a("li",[a("span",{staticClass:"wavesync",on:{click:function(e){return t.select("wavesync")}}},[a("img",{attrs:{src:i("6755"),alt:"Wavesync"}})])])])]),a("Settings")],1)},be=[],pe=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"settings"},[i("form",[i("label",[i("div",{staticClass:"checkbox-container"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.alwaysShowAlbumArt,expression:"alwaysShowAlbumArt"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.alwaysShowAlbumArt)?t._i(t.alwaysShowAlbumArt,null)>-1:t.alwaysShowAlbumArt},on:{change:function(e){var i=t.alwaysShowAlbumArt,a=e.target,n=!!a.checked;if(Array.isArray(i)){var s=null,r=t._i(i,s);a.checked?r<0&&(t.alwaysShowAlbumArt=i.concat([s])):r>-1&&(t.alwaysShowAlbumArt=i.slice(0,r).concat(i.slice(r+1)))}else t.alwaysShowAlbumArt=n}}}),i("Check")],1),i("span",[t._v("Always Show Album Artwork")])]),i("label",[i("div",{staticClass:"checkbox-container"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.alwaysShowTrackInfo,expression:"alwaysShowTrackInfo"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.alwaysShowTrackInfo)?t._i(t.alwaysShowTrackInfo,null)>-1:t.alwaysShowTrackInfo},on:{change:function(e){var i=t.alwaysShowTrackInfo,a=e.target,n=!!a.checked;if(Array.isArray(i)){var s=null,r=t._i(i,s);a.checked?r<0&&(t.alwaysShowTrackInfo=i.concat([s])):r>-1&&(t.alwaysShowTrackInfo=i.slice(0,r).concat(i.slice(r+1)))}else t.alwaysShowTrackInfo=n}}}),i("Check")],1),i("span",[t._v("Always Show Track Info")])])])])},ye=[],we=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M9 21.035l-9-8.638 2.791-2.87 6.156 5.874 12.21-12.436 2.843 2.817z"}})])},ke=[],Se={},Oe=Object(r["a"])(Se,we,ke,!1,null,null,null),xe=Oe.exports,_e={components:{Check:xe},computed:{alwaysShowTrackInfo:{get:function(){return this.$store.state.alwaysShowTrackInfo},set:function(t){this.$store.commit(bt,t)}},alwaysShowAlbumArt:{get:function(){return this.$store.state.alwaysShowAlbumArt},set:function(t){this.$store.commit(pt,t)}}}},je=_e,Te=(i("fe15"),i("92a9"),Object(r["a"])(je,pe,ye,!1,null,"32749fa9",null)),Ae=Te.exports,Ce={kaleidosync:0,blobs:1,trails:2,wavesync:3},ze={components:{Settings:Ae,Check:xe},computed:Object(d["a"])({},Object(f["b"])(["selectedVisualizer","alwaysShowAlbumArt","alwaysShowTrackInfo"])),methods:{select:function(t){this.$store.commit(ft,t),this.$ga&&this.$ga.event({eventCategory:"visualizer",eventAction:"selected",eventLabel:t,eventValue:Ce[t]})}}},Ie=ze,Ee=(i("90d4"),Object(r["a"])(Ie,ge,be,!1,null,"69d8327e",null)),Me=Ee.exports,Pe=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("button",[i("svg",{attrs:{viewBox:"0 0 482.239 482.239",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"m0 17.223v120.56h34.446v-103.337h103.337v-34.446h-120.56c-9.52 0-17.223 7.703-17.223 17.223z"}}),i("path",{attrs:{d:"m465.016 0h-120.56v34.446h103.337v103.337h34.446v-120.56c0-9.52-7.703-17.223-17.223-17.223z"}}),i("path",{attrs:{d:"m447.793 447.793h-103.337v34.446h120.56c9.52 0 17.223-7.703 17.223-17.223v-120.56h-34.446z"}}),i("path",{attrs:{d:"m34.446 344.456h-34.446v120.56c0 9.52 7.703 17.223 17.223 17.223h120.56v-34.446h-103.337z"}})])])},Fe=[],Ve=(i("3cf0"),{}),Re=Object(r["a"])(Ve,Pe,Fe,!1,null,"2210c9bc",null),$e=Re.exports,Le={name:"visualizer",components:{NowPlaying:Zt,Spinner:ae,Toast:le,Hamburger:me,Header:Me,FullScreen:$e},computed:Object(d["a"])({},Object(f["b"])(["menuVisible","spinnerVisible","toast","selectedVisualizer"])),watch:{selectedVisualizer:function(t){this.configSelectedVisualizer(t)}},methods:{mousemove:function(){this.$store.dispatch("hover")},watchers:function(){var t=this;this.multiviz.sync.state.watch("loadingNextSong",function(e){t.$store.commit(xt,e),t.$store.commit(kt,!1)}),this.multiviz.sync.state.watch("currentlyPlaying",function(e){t.$store.commit(_t,e)}),this.multiviz.sync.state.watch("noPlayback",function(e){!0===e?(t.$store.commit(jt,!0),t.$store.dispatch("toast",{message:"No playback detected",autoHide:!1}),t.$store.commit(jt,!1)):t.$store.commit(kt,!1)})},configSelectedVisualizer:function(t){var e=36e4,i=window.innerWidth*window.innerHeight<=e;this.multiviz.selectedVisualizer=t,"trails"===t&&(this.multiviz.sketch.setSize(!0),this.multiviz.sync.state.volumeSmoothing=15,this.multiviz.sync.state.volumeAverage=200),"kaleidosync"===t&&(this.multiviz.sketch.setSize(i),this.multiviz.sync.state.volumeSmoothing=40,this.multiviz.sync.state.volumeAverage=400),"wavesync"===t&&(this.multiviz.sketch.setSize(i),this.multiviz.sync.state.volumeSmoothing=60,this.multiviz.sync.state.volumeAverage=400),"blobs"===t&&(this.multiviz.sketch.setSize(!0),this.multiviz.sync.state.volumeSmoothing=5,this.multiviz.sync.state.volumeAverage=400),"purple"===t&&(this.multiviz.sketch.setSize(i),this.multiviz.sync.state.volumeSmoothing=5,this.multiviz.sync.state.volumeAverage=20)}},mounted:function(){var t=this;document.getElementsByTagName("canvas")[0]||(this.multiviz=new qt(this.selectedVisualizer),this.$store.dispatch("toast",{message:"Connecting to Spotify"}),this.configSelectedVisualizer(this.selectedVisualizer),window.addEventListener("resize",function(){t.configSelectedVisualizer(t.selectedVisualizer)}),this.watchers(),this.$ga&&(this.$ga.page("/visualizer"),this.$ga.event({eventCategory:"visualizer",eventAction:"mounted",eventLabel:this.selectedVisualizer,eventValue:Ce[this.selectedVisualizer]})))},beforeMount:function(){document.body.addEventListener("mousemove",this.mousemove.bind(this)),document.body.addEventListener("touchstart",this.mousemove.bind(this))},beforeDestroy:function(){document.body.removeEventListener("mousemove",this.mousemove.bind(this)),document.body.removeEventListener("touchstart",this.mousemove.bind(this))}},De=Le,He=(i("de6b"),Object(r["a"])(De,It,Et,!1,null,null,null)),Ne=He.exports;a["a"].use(u["a"]);var Be,We=new u["a"]({mode:"history",base:"/",routes:[{path:"/",name:"home",component:zt},{path:"/visualizer",name:"visualizer",component:Ne}]}),qe=i("bfa9"),Qe={login:function(){var t=Object(z["a"])(regeneratorRuntime.mark(function t(){var e,i,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e="",t.next=3,N(e+"/auth");case 3:i=t.sent,a=i.data,a.auth_id&&(window.location.href="".concat(e,"/login?auth_id=").concat(a.auth_id));case 6:case"end":return t.stop()}},t)}));function e(){return t.apply(this,arguments)}return e}(),hover:function(t){var e=t.commit;e(yt,!0),e(wt,function(t){!1===t.settingsVisible&&e(yt,!1)})},toast:function(t,e){var i=t.commit,a=e.message,n=e.autoHide,s=void 0===n||n;i(kt,!1),i(St,{message:a,autoHide:s}),i(kt,!0)},hideAll:function(t){var e=t.commit;e(jt,!0)}},Ge=i("bd86"),Ue=(Be={},Object(Ge["a"])(Be,jt,function(t,e){t.hideAll=e}),Object(Ge["a"])(Be,wt,function(t,e){clearTimeout(t.hoverTimeout),t.hoverTimeout=setTimeout(function(){e(t)},t.hoverDelay)}),Object(Ge["a"])(Be,pt,function(t,e){t.alwaysShowAlbumArt=e}),Object(Ge["a"])(Be,bt,function(t,e){t.alwaysShowTrackInfo=e}),Object(Ge["a"])(Be,mt,function(t,e){t.albumArtVisible=e}),Object(Ge["a"])(Be,gt,function(t,e){t.trackInfoVisible=e}),Object(Ge["a"])(Be,dt,function(t,e){t.menuVisible=e}),Object(Ge["a"])(Be,yt,function(t,e){t.hover=e,document.body.style.cursor=!0===e?"default":"none"}),Object(Ge["a"])(Be,xt,function(t,e){t.spinnerVisible=e}),Object(Ge["a"])(Be,_t,function(t,e){t.currentlyPlaying=e}),Object(Ge["a"])(Be,Ot,function(t,e){var i=Object(b["a"])(e,3),a=i[0],n=i[1],s=i[2];t.color="rgb(".concat(a,",").concat(n,",").concat(s,")")}),Object(Ge["a"])(Be,kt,function(t,e){t.toast.visible=e}),Object(Ge["a"])(Be,St,function(t,e){var i=e.message,a=e.autoHide;t.toast.message=i,t.toast.autoHide=a}),Object(Ge["a"])(Be,ft,function(t,e){t.selectedVisualizer=e}),Be);a["a"].use(f["a"]);var Ke=new qe["a"]({storage:window.localStorage,key:"kaleidosync-persist",reducer:function(t){var e=t.alwaysShowAlbumArt,i=t.alwaysShowTrackInfo,a=t.selectedVisualizer;return{alwaysShowAlbumArt:e,alwaysShowTrackInfo:i,selectedVisualizer:a}}}),Ye=Ke.plugin,Ze=new f["a"].Store({state:{alwaysShowAlbumArt:!1,alwaysShowTrackInfo:!1,albumArtVisible:!1,trackInfoVisible:!1,hideAll:!1,trackProgress:{progress:0,duration:0,percent:100},colorTransitionDuration:1e3,hoverTimeout:0,hoverTimestamp:0,hoverDelay:1e3,shadeVisible:!0,menuVisible:!1,settingsVisible:!1,hover:!1,spinnerVisible:!1,slowerSpeed:!1,color:"rgba(0,0,0,.5)",colorScheme:{},currentlyPlaying:{},selectedVisualizer:"kaleidosync",toast:{visible:!1,message:"",autohide:!0}},mutations:Ue,actions:Qe,plugins:[Ye]});i("0284");a["a"].config.productionTip=!1,new a["a"]({router:We,store:Ze,render:function(t){return t(l)}}).$mount("#app")},"5c0b":function(t,e,i){"use strict";var a=i("5e27"),n=i.n(a);n.a},"5e27":function(t,e,i){},6755:function(t,e,i){t.exports=i.p+"img/wavesync.7d9f3a73.png"},"754d":function(t,e,i){t.exports=i.p+"img/kaleidosync.9d52d8a8.png"},"7c12":function(t,e,i){},8876:function(t,e,i){"use strict";var a=i("4158"),n=i.n(a);n.a},"8fa8":function(t,e,i){},"90d4":function(t,e,i){"use strict";var a=i("1532"),n=i.n(a);n.a},"92a9":function(t,e,i){"use strict";var a=i("24c5"),n=i.n(a);n.a},a2ac:function(t,e,i){"use strict";var a=i("b383"),n=i.n(a);n.a},ae3c:function(t,e,i){"use strict";var a=i("f0ff"),n=i.n(a);n.a},afab:function(t,e,i){},b383:function(t,e,i){},bfcb:function(t,e,i){"use strict";var a=i("07a3"),n=i.n(a);n.a},c998:function(t,e,i){},d995:function(t,e,i){"use strict";var a=i("afab"),n=i.n(a);n.a},de6b:function(t,e,i){"use strict";var a=i("8fa8"),n=i.n(a);n.a},f0ff:function(t,e,i){},fd42:function(t,e,i){"use strict";var a=i("7c12"),n=i.n(a);n.a},fe15:function(t,e,i){"use strict";var a=i("c998"),n=i.n(a);n.a}});
//# sourceMappingURL=app.e25370ac.js.map